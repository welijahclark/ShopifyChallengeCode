########
#Part A#
########

#Uploading and viewing the dataset into R
> library(readr)
Warning message:
package ‘readr’ was built under R version 3.6.3 
> X2019_Winter_Data_Science_Intern_Challenge_Data_Set_Sheet1 <- read_csv("All Documents/Career Stuff/Shopify Challenge/2019 Winter Data Science Intern Challenge Data Set - Sheet1.csv")
> View(X2019_Winter_Data_Science_Intern_Challenge_Data_Set_Sheet1)

#Declaring variables and obtaining the mean
> orderamount <- X2019_Winter_Data_Science_Intern_Challenge_Data_Set_Sheet1$order_amount
> mean(orderamount)
[1] 3145.128

#This is how the original AOV of $3145.13 would have been obtained. We could either do some mathematical manipulation of the data or some data cleaning to
come up with a better metric for AOV.

########
#Part B#
########

#Method 1: Arithmetic Approach

#Declaring more variables and re-arranging a different mean
> totalitems <- X2019_Winter_Data_Science_Intern_Challenge_Data_Set_Sheet1$total_items
> individualorderaverage <- orderamount/totalitems
> mean(individualorderaverage)
[1] 387.7428

#387.7428 is better, but still seems somewhat unrealistic for sneakers. so let's remove some outliers based on what I can see in the dataset.

#Method 2: Outlier Replace Funtionality + Recalculating

library(data.table)
outlierReplace = function(dataframe, cols, rows, newValue = NA) {
    if (any(rows)) {
        set(dataframe, rows, cols, newValue)
    }
}
> outlierReplace(X2019_Winter_Data_Science_Intern_Challenge_Data_Set_Sheet1, "order_amount", which(X2019_Winter_Data_Science_Intern_Challenge_Data_Set_Sheet1$order_amount > 1000), NA)
> mean(na.omit(orderamount))
[1] 301.0643

# $301.0643 is even better, but it is possible that the data is skewed due to the presence of some very specific models of sneakers (perhaps some limited 
edition Air Jordans). We can check the median as well to see if this is the case.

> median(na.omit(orderamount))
[1] 284

# With $284 as our median and as a more realistic AOV, we can note that the distribution of our orders is right skewed based on the previous mean of $301.0643.
# Thus, it would be more realistic to say that $284 serves as a better metric for AOV.
